# 测试说明

本目录包含 `lrh-eslint` 项目的测试文件。

## 测试文件结构

- `linter.test.ts` - 单元测试，测试各个函数的独立功能

## 运行测试

### 运行所有测试
```bash
npm test
```

### 运行测试并显示覆盖率
```bash
npm run test:coverage
```

### 运行测试（一次性）
```bash
npm run test:run
```

## 测试内容

### 单元测试 (`linter.test.ts`)

测试以下函数的独立功能：

1. **getCode** - 文件读取功能
   - ✅ 成功读取文件内容
   - ✅ 处理文件读取错误

2. **getAST** - AST 解析功能
   - ✅ 正确解析代码生成 AST
   - ✅ 处理 AST 解析错误

3. **traverseAST** - AST 遍历功能
   - ✅ 正确调用 estraverse.traverse

4. **worker** - 单个文件处理功能
   - ✅ 处理单个文件的完整流程
   - ✅ 处理文件读取失败的情况
   - ✅ 处理 AST 解析失败的情况

5. **run** - 主运行函数
   - ✅ 处理指定路径的文件
   - ✅ 处理无参数情况
   - ✅ 处理参数优先级（path 优先于 isGlobal）

## 测试覆盖情况

当前测试覆盖了 `linter.ts` 中的核心功能：
- ✅ 文件读取和错误处理
- ✅ AST 解析和错误处理
- ✅ AST 遍历调用
- ✅ 单文件处理流程
- ✅ 主函数的基本逻辑和参数处理

## 测试技术栈

- **Vitest** - 测试框架
- **Mock** - 模拟依赖（fs, path, espree, estraverse, chalk）
- **TypeScript** - 类型安全的测试代码

## 注意事项

1. 测试使用了大量的 mock 来隔离外部依赖
2. 测试覆盖了错误处理和边界情况
3. 所有测试都使用中文描述，便于理解测试目的
4. 当前测试专注于核心功能的单元测试，确保代码的稳定性和可靠性
5. 为了避免复杂性和潜在的内存问题，暂时不包含 `getAllJsFile` 函数的递归测试 